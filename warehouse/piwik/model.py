import sqlalchemy as s

import warehouse.model as m

class PiwikLogVisit(m.Fact):
    idvisit = m.Column(s.Integer, primary_key = True)
    idsite = m.Column(s.Integer)
    idvisitor = m.Column(s.LargeBinary(8))
    visitor_localtime = m.Column(s.Time)
    visitor_returning = m.Column(s.Boolean)
    visitor_count_visits = m.Column(s.Integer)
    visitor_days_since_last = m.Column(s.Integer)
    visitor_days_since_order = m.Column(s.Integer)
    visitor_days_since_first = m.Column(s.Integer)
    visit_first_action_time = m.Column(s.DateTime)
    visit_last_action_time = m.Column(s.DateTime)
    visit_exit_idaction_url = m.Column(s.Integer, default = 0)
    visit_exit_idaction_name = m.Column(s.Integer)
    visit_entry_idaction_url = m.Column(s.Integer)
    visit_entry_idaction_name = m.Column(s.Integer)
    visit_total_actions = m.Column(s.Integer)
    visit_total_searches = m.Column(s.Integer)
    visit_total_events = m.Column(s.Integer)
    visit_total_time = m.Column(s.Integer)
    visit_goal_converted = m.Column(s.Integer)
    visit_goal_buyer = m.Column(s.Integer)
    referer_type = m.Column(s.Integer, nullable = True)
    referer_name = m.Column(s.VARCHAR(70), nullable = True)
    referer_url = m.Column(s.Text)
    referer_keyword = m.Column(s.VARCHAR(255), nullable = True)
    config_id = m.Column(s.LargeBinary(8))
    config_os = m.Column(s.CHAR(3))
    config_os_version = m.Column(s.VARCHAR(100), nullable = True)
    config_browser_name = m.Column(s.VARCHAR(10))
    config_browser_version = m.Column(s.VARCHAR(20))
    config_device_type = m.Column(s.Integer, nullable = True)
    config_device_brand = m.Column(s.VARCHAR(100), nullable = True)
    config_device_model = m.Column(s.VARCHAR(100), nullable = True)
    config_resolution = m.Column(s.VARCHAR(9))
    config_pdf = m.Column(s.Boolean)
    config_flash = m.Column(s.Boolean)
    config_java = m.Column(s.Boolean)
    config_director = m.Column(s.Boolean)
    config_quicktime = m.Column(s.Boolean)
    config_realplayer = m.Column(s.Boolean)
    config_windowsmedia = m.Column(s.Boolean)
    config_gears = m.Column(s.Boolean)
    config_silverlight = m.Column(s.Boolean)
    config_cookie = m.Column(s.Boolean)
    location_ip = m.Column(s.LargeBinary(16))
    location_browser_lang = m.Column(s.VARCHAR(20))
    location_country = m.Column(s.CHAR(3))
    location_region = m.Column(s.CHAR(2), nullable = True)
    location_city = m.Column(s.VARCHAR(255), nullable = True)
    location_latitude = m.Column(s.Float(10,6), nullable = True)
    location_longitude = m.Column(s.Float(10,6), nullable = True)
    custom_var_k1 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_v1 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_k2 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_v2 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_k3 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_v3 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_k4 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_v4 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_k5 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_v5 = m.Column(s.VARCHAR(200), nullable = True)
    location_provider = m.Column(s.VARCHAR(100), nullable = True)
#   KEY `index_idsite_config_datetime` (`idsite`,`config_id`,`visit_last_action_time`),
#   KEY `index_idsite_datetime` (`idsite`,`visit_last_action_time`),
#   KEY `index_idsite_idvisitor` (`idsite`,`idvisitor`)

CREATE TABLE `piwik_log_link_visit_action` (
    idlink_va = m.Column(s.Integer)
    idsite = m.Column(s.Integer)
    idvisitor = m.Column(s.LargeBinary(8))
    server_time = m.Column(s.DateTime)
    idvisit = m.Column(s.Integer)
    idaction_url = m.Column(s.Integer, nullable = True)
    idaction_url_ref = m.Column(s.Integer, default = 0)
    idaction_name = m.Column(s.Integer, nullable = True)
    idaction_name_ref = m.Column(s.Integer)
    idaction_event_category = m.Column(s.Integer, nullable = True)
    idaction_event_action = m.Column(s.Integer, nullable = True)
    time_spent_ref_action = m.Column(s.Integer)
    custom_var_k1 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_v1 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_k2 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_v2 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_k3 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_v3 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_k4 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_v4 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_k5 = m.Column(s.VARCHAR(200), nullable = True)
    custom_var_v5 = m.Column(s.VARCHAR(200), nullable = True)
    custom_float = m.Column(s.Float, nullable = True)
  # KEY `index_idvisit` (`idvisit`),
  # KEY `index_idsite_servertime` (`idsite`,`server_time`)
