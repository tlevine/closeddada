#!/usr/bin/env python3
import subprocess
import webbrowser
import time

import sys
sys.path.append('.')

import warehouse.main
warehouse.main.export_model()

slicer = subprocess.Popen(['slicer', 'serve', 'slicer.ini'],
                          stdout = sys.stdout, stderr = sys.stderr)

if webbrowser.open_new('http://localhost:5000'):
    time.sleep(3)
    sys.stdout.write(' * Opened web browser\n')
    slicer.wait()
else:
    slicer.kill()
    sys.stderr.write('Could not open web browser\n')
